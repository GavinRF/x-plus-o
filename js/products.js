const PRODUCTS = {
  womens_tops: [
    {
      id: 1,
      name: "Dreamy Horizons",
      price: 42.00,
      salePrice: 29.40,
      category: "TEES",
      image: "img/product/shirt/Shirt10.jpg",
      description: "Soft cotton tee with layered landscape design in pastel blues and sunshine yellow. Wearable art meets everyday comfort."
    },
    {
      id: 2,
      name: "Rockabilly",
      price: 21.15,
      salePrice: 19.40,
      category: "BUTTON UP TEE",
      image: "img/product/shirt/Shirt11.jpg",
      description: "Classic button-up with retro vibes and modern comfort."
    },
    {
      id: 3,
      name: "Shape Shifter",
      price: 48.00,
      salePrice: 33.60,
      category: "TOPS",
      image: "img/product/shirt/Shirt12.jpg",
      description: "Classic Memphis design with organic shapes in coral, navy, and mint. Abstract art meets everyday wearability."
    },
    {
      id: 4,
      name: "Tropical State of Mind",
      price: 38.00,
      salePrice: 26.60,
      category: "TEES",
      image: "img/product/shirt/Shirt21.jpg",
      description: "Palm leaf graphics on crisp white cotton with golden sun backdrop. Vacation vibes for any day of the week."
    },
    {
      id: 5,
      name: "Color Block Dreams",
      price: 89.00,
      salePrice: 62.30,
      category: "KNITWEAR",
      image: "img/product/shirt/Shirt5.png",
      description: "Bold color-blocked knit sweater with painterly brushstrokes in electric blue, coral pink, and sunshine yellow."
    },
  {
    "id": 6,
    "name": "Confetti Celebration",
    "price": 65.00,
    "salePrice": 52.60,
    "category": "BLOUSES",
    "image": "img/product/shirt/Shirt6.png",
    "description": "Playful button-up featuring organic shapes and golden polka dots on cream base. A modern take on abstract expressionism you can wear."
  },
  {
    "id": 7,
    "name": "Sunset Blocks",
    "price": 58.00,
    "salePrice": 40.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt7.jpg",
    "description": "Vibrant geometric color blocking in emerald, coral, and sky blue. Bold stripes meet modern art in this statement piece."
  },
  {
    "id": 8,
    "name": "Memphis Mayhem",
    "price": 45.00,
    "salePrice": 30.42,
    "category": "TEES",
    "image": "img/product/shirt/Shirt26.jpg",
    "description": "Pure 80s Memphis magic with squiggles, dots, and geometric shapes in primary colors. Retro-futurism at its finest."
  },
  {
    "id": 9,
    "name": "Midnight Garden",
    "price": 72.00,
    "salePrice": 66.60,
    "category": "BLOUSES",
    "image": "img/product/shirt/Shirt32.png",
    "description": "Sophisticated button-up with abstract florals and brushstrokes on black canvas. Dark romanticism meets modern art."
  },
  {
    "id": 10,
    "name": "Retro Future Crop",
    "price": 68.00,
    "salePrice": 51.20,
    "category": "SWEATSHIRTS",
    "image": "img/product/shirt/Shirt34.jpg",
    "description": "Cropped sweatshirt featuring classic Memphis patterns - stripes, dots, and geometric chaos. 80s energy for modern rebels."
  }

  ],
  
  dresses: [
  {
    "id": 11,
    "name": "Market Day Midi",
    "price": 78.00,
    "salePrice": 69.99,
    "category": "DRESSES",
    "image": "img/product/dress/dress1.jpg",
    "description": "Strapless midi dress with abstract blob print in coral and navy on soft pink canvas. Perfect for farmers market strolls and weekend adventures."
  },
  {
    "id": 12,
    "name": "Eclipse Elegance",
    "price": 95.00,
    "salePrice": 88.90,
    "category": "DRESSES",
    "image": "img/product/dress/dress2.jpg",
    "description": "Sophisticated sleeveless dress featuring bold geometric color blocking with white circle motif and sunshine yellow hem. Modern minimalism meets Memphis style."
  },
  {
    "id": 13,
    "name": "Tropical Halter Jumpsuit",
    "price": 88.00,
    "salePrice": 79.99,
    "category": "JUMPSUITS",
    "image": "img/product/dress/dress3.png",
    "description": "Vibrant halter jumpsuit with abstract leaf print in sunset colors. Belted waist and flowing silhouette for effortless vacation vibes."
  },
  {
    "id": 14,
    "name": "Santorini Sunset",
    "price": 85.00,
    "salePrice": 78.99,
    "category": "MAXI DRESSES",
    "image": "img/product/dress/dress4.jpg",
    "description": "Strapless maxi dress with bold color blocks in coral and cobalt blue. Mediterranean-inspired design perfect for seaside evenings."
  },
  {
    "id": 15,
    "name": "Memphis Mondrian Mini",
    "price": 65.00,
    "salePrice": 58.99,
    "category": "MINI DRESSES",
    "image": "img/product/dress/dress5.jpg",
    "description": "Short sleeve mini dress covered in authentic Memphis patterns - grids, dots, and geometric shapes in primary colors. Pure 80s architectural energy."
  },
  {
    "id": 16,
    "name": "Pattern Play Tiered",
    "price": 92.00,
    "salePrice": 85.99,
    "category": "MIDI DRESSES",
    "image": "img/product/dress/skirt.jpg",
    "description": "Sleeveless tiered midi dress in electric blue with abstract pattern mix including animal prints and geometric shapes. Playful maximalism at its finest."
  },
  {
    "id": 17,
    "name": "Abstract Garden Maxi",
    "price": 110.00,
    "salePrice": 103.99,
    "category": "MAXI DRESSES",
    "image": "img/product/dress/dress7.png",
    "description": "Flowing spaghetti strap maxi dress with bold abstract floral print in turquoise, coral, and navy. Artistic expression meets bohemian elegance."
  },
  {
    "id": 18,
    "name": "Neon Nights Mini",
    "price": 72.00,
    "salePrice": 65.99,
    "category": "MINI DRESSES",
    "image": "img/product/dress/dress8.jpg",
    "description": "Long-sleeve mini dress with electric Memphis pattern in neon brights and geometric shapes. Bold turtleneck design for the fearlessly fashionable."
  }
],
  
  pants: [
  {
    "id": 19,
    "name": "Primary Pop Shorts",
    "price": 68.00,
    "salePrice": 51.70,
    "category": "SHORTS",
    "image": "img/product/pants/pants1.jpg",
    "description": "High-waisted denim shorts with bold color-blocked panels in red, blue, yellow, and green. Classic meets contemporary in this playful Memphis-inspired design."
  },
  {
    "id": 20,
    "name": "Geometric Glitch Set",
    "price": 145.00,
    "salePrice": 128.00,
    "category": "SETS",
    "image": "img/product/pants/pants2.jpg",
    "description": "Two-piece set featuring abstract geometric patterns in neon brights. Sleeveless top and matching high-waisted pants for the ultimate statement look."
  },
  {
    "id": 21,
    "name": "Pattern Mix Madness",
    "price": 158.00,
    "salePrice": 141.70,
    "category": "SHORTS",
    "image": "img/product/pants/pants3.jpg",
    "description": "Collection of color-blocked shorts featuring stripes, solids, and mixed patterns. Each pair is a unique work of wearable art in bright Memphis colors."
  },
  {
    "id": 22,
    "name": "Street Art Trousers",
    "price": 95.00,
    "salePrice": 78.84,
    "category": "PANTS",
    "image": "img/product/pants/pants4.jpg",
    "description": "Straight-leg pants covered in graffiti-inspired Memphis patterns with checkered details. Urban edge meets 80s design rebellion."
  },
  {
    "id": 23,
    "name": "Dalmatian Dreams",
    "price": 52.00,
    "salePrice": 35.44,
    "category": "SHORTS",
    "image": "img/product/pants/pants5.jpg",
    "description": "High-waisted denim shorts with playful black and white cow print detailing. A fun twist on the classic animal print trend."
  },
  {
    "id": 24,
    "name": "Stripe & Block Fusion",
    "price": 65.00,
    "salePrice": 48.90,
    "category": "SHORTS",
    "image": "img/product/pants/pants6.jpg",
    "description": "Color-blocked denim shorts combining solid panels with bold blue and white stripes. Perfect balance of pattern and color for summer adventures."
  },
  {
    "id": 25,
    "name": "Digital Pop Jeans",
    "price": 78.00,
    "salePrice": 63.70,
    "category": "JEANS",
    "image": "img/product/pants/pants7.jpg",
    "description": "Relaxed-fit jeans featuring abstract digital-inspired prints in electric blues and bright accents. Comfort meets contemporary art."
  },
  {
    "id": 26,
    "name": "Shape Shuffle Shorts",
    "price": 48.00,
    "salePrice": 33.95,
    "category": "SHORTS",
    "image": "img/product/pants/pants8.jpg",
    "description": "Memphis-inspired shorts with scattered geometric shapes and organic forms on dark background. Abstract minimalism for the bold dresser."
  },
  {
    "id": 27,
    "name": "Color Patch Vintage",
    "price": 72.00,
    "salePrice": 58.00,
    "category": "SHORTS",
    "image": "img/product/pants/pants12.jpg",
    "description": "High-waisted vintage-wash denim shorts with colorful geometric pocket details in orange, green, and red. Retro meets modern patchwork style."
  },
  {
    "id": 28,
    "name": "Abstract Swim Shorts",
    "price": 45.00,
    "salePrice": 30.00,
    "category": "SWIM SHORTS",
    "image": "img/product/pants/pants14.jpg",
    "description": "Quick-dry swim shorts with bold abstract print featuring organic shapes and Memphis-style color blocking. Pool party ready with artistic flair."
  }
],
  
  accessories: [
  {
    "id": 29,
    "name": "Retro Vibes Sunglasses Set",
    "price": 45.00,
    "salePrice": 30.00,
    "category": "SUNGLASSES",
    "image": "img/product/accessories/accessories1.jpg",
    "description": "Three-piece sunglasses collection featuring yellow mirrored aviators, tortoiseshell rounds, and rose gold classics. Complete your vintage-inspired look with these timeless frames."
  },
  {
    "id": 30,
    "name": "Memphis Shape Earrings",
    "price": 28.00,
    "salePrice": 22.00,
    "category": "EARRINGS",
    "image": "img/product/accessories/accessories2.jpg",
    "description": "Playful acrylic earrings featuring abstract shapes in primary Memphis colors. Lightweight dangles perfect for adding a pop of 80s-inspired geometric fun to any outfit."
  },
  {
    "id": 31,
    "name": "Coral Stripe Statement Shades",
    "price": 52.00,
    "salePrice": 46.00,
    "category": "SUNGLASSES",
    "image": "img/product/accessories/accessories3.jpg",
    "description": "Bold coral frames with black and white striped temple details. Oversized square lenses with gradient tint for maximum UV protection and style impact."
  },
  {
    "id": 32,
    "name": "Geometric Mix Earring Set",
    "price": 35.00,
    "salePrice": 29.80,
    "category": "EARRINGS",
    "image": "img/product/accessories/accessories4.jpg",
    "description": "Colorful acrylic earring collection featuring circles, squares, and abstract shapes in Memphis-inspired color combinations. Mix and match for endless styling possibilities."
  },
  {
    "id": 33,
    "name": "Color Block Statement Drops",
    "price": 42.00,
    "salePrice": 36.00,
    "category": "EARRINGS",
    "image": "img/product/accessories/accessories5.jpg",
    "description": "Oversized acrylic earrings with orange rectangles, mint circles, and navy arch details. Bold architectural jewelry that makes every outfit a statement piece."
  },
  {
    "id": 34,
    "name": "Pattern Puzzle Sunglasses",
    "price": 65.00,
    "salePrice": 59.00,
    "category": "SUNGLASSES",
    "image": "img/product/accessories/accessories6.jpg",
    "description": "Unique round frames in soft pink with geometric pattern temples and blue accent details. Handcrafted design that\'s part art piece, part eyewear."
  },
  {
    "id": 35,
    "name": "Memphis Mondrian Shades",
    "price": 58.00,
    "salePrice": 52.00,
    "category": "SUNGLASSES",
    "image": "img/product/accessories/accessories7.jpg",
    "description": "Round yellow frames with polka dot temples and geometric color blocking. A tribute to both Memphis design and Mondrian\'s color theory in wearable form."
  },
  {
    "id": 36,
    "name": "Pop Art Timepiece",
    "price": 125.00,
    "category": "WATCHES",
    "image": "img/product/accessories/accessories8.jpg",
    "description": "Statement watch with Memphis-inspired face design and coral leather strap. Bold rectangular case with artistic dial featuring geometric patterns and bright colors."
  },
  {
    "id": 37,
    "name": "Checkered Rebel Sneakers",
    "price": 85.00,
    "salePrice": 70.00,
    "category": "SHOES",
    "image": "img/product/accessories/accessories9.jpg",
    "description": "Low-top canvas sneakers with black and white checkered pattern, neon yellow stripe, and hot pink heel details. Street art meets classic skate shoe design."
  },
  {
    "id": 38,
    "name": "Neon Rain Boots",
    "price": 48.00,
    "category": "SHOES",
    "image": "img/product/accessories/accessories10.jpg",
    "description": "Transparent rain boots with coral and mint color blocking. Waterproof design with cotton candy laces and matching striped socks for puddle-jumping in style."
  },
  {
    "id": 39,
    "name": "Color Block Architect Frames",
    "price": 68.00,
    "salePrice": 62.00,
    "category": "SUNGLASSES",
    "image": "img/product/accessories/accessories11.jpg",
    "description": "Oversized square frames in powder blue with yellow accent band and geometric temple details. Architectural eyewear inspired by Memphis design movement."
  },
  {
    "id": 40,
    "name": "Lightning Bolt Dangles",
    "price": 32.00,
    "salePrice": 26.00,
    "category": "EARRINGS",
    "image": "img/product/accessories/accessories12.jpg",
    "description": "Dynamic acrylic earrings featuring white zigzag lightning bolts with teal and purple geometric elements. Electric energy captured in wearable Memphis-style art."
  },
  {
    "id": 41,
    "name": "Holographic Triangle Hoops",
    "price": 38.00,
    "salePrice": 32.00,
    "category": "EARRINGS",
    "image": "img/product/accessories/accessories13.jpg",
    "description": "Clear acrylic triangle earrings with holographic Memphis squiggles and colorful dots. Futuristic design meets 80s nostalgia in these eye-catching statement hoops."
  }
],
  
  mens: [
  {
    "id": 42,
    "name": "Crystal Kaleidoscope Button-Up",
    "price": 68.00,
    "salePrice": 51.70,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt1.jpg",
    "description": "Short-sleeve button-up featuring abstract geometric crystals in coral, pink, and mint. Angular Memphis design that catches light and attention wherever you go."
  },
  {
    "id": 43,
    "name": "Pop Culture Patchwork",
    "price": 85.00,
    "salePrice": 68.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt2.jpg",
    "description": "Maximalist short-sleeve shirt with collage-style print mixing geometric patterns, pop art elements, and vibrant color blocks. Street art meets high fashion."
  },
  {
    "id": 44,
    "name": "Memphis Geometry Vacation Shirt",
    "price": 58.00,
    "salePrice": 41.80,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt3.jpg",
    "description": "Classic camp collar shirt in hot pink with scattered Memphis shapes, dots, and geometric elements. Perfect for pool parties and weekend adventures."
  },
  {
    "id": 45,
    "name": "Retro Surf Club Button-Up",
    "price": 75.00,
    "salePrice": 60.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt8.jpg",
    "description": "Oversized button-up with striped collar and abstract wave patterns in primary colors. Vintage 80s surf culture meets Memphis design movement."
  },
  {
    "id": 46,
    "name": "Bauhaus Block Party Shirt",
    "price": 72.00,
    "salePrice": 57.46,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt9.jpg",
    "description": "Short-sleeve shirt featuring interlocking geometric blocks in forest green, cream, and orange. Architectural design inspired by Bauhaus and Memphis styles."
  },
  {
    "id": 47,
    "name": "Abstract Fragments Button-Up",
    "price": 65.00,
    "salePrice": 50.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt14.jpg",
    "description": "Relaxed-fit shirt with scattered coral geometric fragments on black canvas. Modern art meets casual wear in this effortlessly cool design."
  },
  {
    "id": 48,
    "name": "Memphis Confetti Classic",
    "price": 62.00,
    "salePrice": 46.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt17.jpg",
    "description": "White button-up covered in colorful Memphis confetti - dots, triangles, and squiggles in primary colors. Pure 80s celebration in shirt form."
  },
  {
    "id": 49,
    "name": "Color Splash Camp Shirt",
    "price": 78.00,
    "salePrice": 63.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt19.jpg",
    "description": "Camp collar shirt with fluid color blocking in coral, mint, and sky blue. Abstract paint splash design perfect for creative souls and summer vibes."
  },
  {
    "id": 50,
    "name": "Patchwork Puzzle Button-Up",
    "price": 88.00,
    "salePrice": 73.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt22.jpg",
    "description": "Artistic short-sleeve shirt with patchwork color blocking in dusty pink, mustard, navy, and cream. Each panel tells part of the Memphis story."
  },
  {
    "id": 51,
    "name": "Postmodern Pattern Mix",
    "price": 92.00,
    "salePrice": 78.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt23.jpg",
    "description": "Black shirt featuring the ultimate Memphis pattern explosion - circles, grids, stripes, and geometric chaos in turquoise, yellow, and pink accents."
  },
  {
    "id": 52,
    "name": "Sprinkles & Shapes Party Shirt",
    "price": 55.00,
    "salePrice": 40.60,
    "category": "SHIRTS",
    "image": "img/product/shirt/Shirt30.jpg",
    "description": "Black and white sprinkle pattern base with scattered primary color shapes. Playful design that brings joy to any occasion or everyday wear."
  }
]
};

// Product renderer class
class ProductRenderer {
  constructor() {
    this.initializeProducts();
  }

  initializeProducts() {
    // Clear existing product sections and rebuild from JSON
    this.renderSection('womens_tops', PRODUCTS.womens_tops, 'WOMEN\'S TOPS');
    this.renderSection('dresses_container', PRODUCTS.dresses, 'DRESSES');
    this.renderSection('pants_container', PRODUCTS.pants, 'PANTS & SHORTS');
    this.renderSection('accessories_container', PRODUCTS.accessories, 'ACCESSORIES');
    this.renderSection('mens_container', PRODUCTS.mens, 'MEN\'S SHORT SLEEVES');
  }

  renderSection(sectionId, products, title) {
    const $container = $(`#${sectionId}`);
    if (!$container.length) {
      console.warn(`Section container #${sectionId} not found`);
      return;
    }

    // Clear existing products (keep any non-product elements like "Load more" sections)
    $container.find('.lg\\:w-1\\/4').remove();

    // Generate product HTML
    const productsHtml = products.map(product => this.generateProductHtml(product)).join('');
    
    // Find any "Load more" section and insert before it, otherwise append
    const $loadMore = $container.find('section');
    if ($loadMore.length) {
      $loadMore.before(productsHtml);
    } else {
      $container.append(productsHtml);
    }
  }

generateProductHtml(product) {
    const pricingHtml = this.generatePricingHtml(product);
    const isFeatured = Math.random() > 0.8; 
    
  return `
    <div class="lg:w-1/4 md:w-1/2 p-4 w-full">
      <div class="product-card-wrapper relative ${isFeatured ? 'featured-product' : ''}">
        <a class="block relative h-48 rounded overflow-hidden product-item cursor-pointer" 
           data-product='${JSON.stringify(product)}'>
          <img alt="ecommerce" 
               loading="lazy"
               class="object-cover object-center w-full h-full block" 
               src="${product.image}">
          
          <!-- Quick Actions -->
          <div class="quick-actions top-2 right-2 flex space-y-2 opacity-0 transition-opacity duration-300">
            <button class="quick-add-btn w-10 h-10 rounded-full flex items-center justify-center shadow-lg hover:bg-pink-500 hover:text-white transition-all duration-200" 
                    data-product='${JSON.stringify(product)}' 
                    title="Add to Cart"
                    >
              <i class="fa-solid fa-cart-plus"></i>
            </button>
            
            <button class="save-btn w-10 h-10 rounded-full flex items-center justify-center shadow-lg hover:bg-blue-500 hover:text-white transition-all duration-200" 
                    data-product='${JSON.stringify(product)}' 
                    data-product-id="${product.id}"
                    title="Save to Wishlist"
                    >
              <i class="fa-regular fa-heart"></i>
            </button>
          </div>
        </a>
        
        <div class="mt-4">
          <h3 class="text-gray-500 text-xs tracking-widest title-font mb-1">${product.category}</h3>
          <h2 class="text-gray-900 title-font text-lg font-medium">
            <a href="#" class="product-item cursor-pointer hover:text-pink-500 transition-colors duration-200" 
               data-product='${JSON.stringify(product)}'>
              ${product.name}
            </a>
          </h2>
          ${pricingHtml}
        </div>
      </div>
    </div>
  `;
}

generateLoadingCard() {
  return `
    <div class="lg:w-1/4 md:w-1/2 p-4 w-full">
      <div class="product-card-wrapper">
        <div class="h-48 rounded overflow-hidden product-loading"></div>
        <div class="mt-4">
          <div class="h-3 bg-gray-200 rounded w-1/3 mb-2 product-loading"></div>
          <div class="h-4 bg-gray-200 rounded w-2/3 mb-2 product-loading"></div>
          <div class="h-4 bg-gray-200 rounded w-1/4 product-loading"></div>
        </div>
      </div>
    </div>
  `;
}

  // Method to generate sale pricing HTML
  generatePricingHtml(product) {
    if (product.salePrice) {
      // Show strikethrough original price and sale price
      const savings = product.price - product.salePrice;
      const savingsPercent = Math.round((savings / product.price) * 100);
      
      return `
        <div class="mt-1">
          <span class="text-blue-600 font-bold">$${product.salePrice.toFixed(2)}</span>
          <span class="text-gray-500 line-through text-sm">$${product.price.toFixed(2)}</span>
        </div>
      `;
    } else {
      // Regular pricing
      return `<p class="mt-1">$${product.price.toFixed(2)}</p>`;
    }
  }

  getCurrentPrice(product) {
    return product.salePrice || product.price;
  }


  // Method to add new product
  addProduct(section, product) {
    PRODUCTS[section].push(product);
    this.renderSection(section.replace('_', ''), PRODUCTS[section], this.getSectionTitle(section));
  }

  // Method to update product
  updateProduct(section, productId, updates) {
    const productIndex = PRODUCTS[section].findIndex(p => p.id === productId);
    if (productIndex !== -1) {
      PRODUCTS[section][productIndex] = { ...PRODUCTS[section][productIndex], ...updates };
      this.renderSection(section.replace('_', ''), PRODUCTS[section], this.getSectionTitle(section));
    }
  }

  // Method to remove product
  removeProduct(section, productId) {
    PRODUCTS[section] = PRODUCTS[section].filter(p => p.id !== productId);
    this.renderSection(section.replace('_', ''), PRODUCTS[section], this.getSectionTitle(section));
  }

  getSectionTitle(section) {
    const titles = {
      'womens_tops': 'WOMEN\'S TOPS',
      'dresses': 'DRESSES',
      'pants': 'PANTS & SHORTS',
      'accessories': 'ACCESSORIES',
      'mens': 'MEN\'S SHORT SLEEVES'
    };
    return titles[section] || section.toUpperCase();
  }

  // Search functionality
  searchProducts(query) {
    const allProducts = Object.values(PRODUCTS).flat();
    return allProducts.filter(product => 
      product.name.toLowerCase().includes(query.toLowerCase()) ||
      product.category.toLowerCase().includes(query.toLowerCase()) ||
      product.description.toLowerCase().includes(query.toLowerCase())
    );
  }

  // Filter by category
  filterByCategory(category) {
    const allProducts = Object.values(PRODUCTS).flat();
    return allProducts.filter(product => 
      product.category.toLowerCase() === category.toLowerCase()
    );
  }

  // Get products by price range
  getProductsByPriceRange(min, max) {
    const allProducts = Object.values(PRODUCTS).flat();
    return allProducts.filter(product => 
      product.price >= min && product.price <= max
    );
  }
}

class QuickActionsHandler {
  constructor() {
    this.savedItems = new Set(); // Store saved product IDs
    this.init();
  }

  init() {
    // Load saved items from localStorage if available
    const saved = localStorage.getItem('savedProducts');
    if (saved) {
      this.savedItems = new Set(JSON.parse(saved));
      this.updateSavedButtonStates();
    }

    // Bind events
    this.bindEvents();
  }

  bindEvents() {
    // Cart button click - delegate to global cart
    $(document).on('click', '.quick-add-btn', (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      try {
        const productData = JSON.parse($(e.currentTarget).attr('data-product'));
        
        if (window.globalCart) {
          window.globalCart.quickAddToCart(productData);
        } else {
          window.toastManager.error('Cart not available. Please try again.', 3000);
        }
      } catch (error) {
        console.error('Error adding to cart:', error);
        window.toastManager.error('Error adding to cart. Please try again.', 3000);
      }
    });

    // Save/heart button click
    $(document).on('click', '.save-btn', (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      try {
        const productData = JSON.parse($(e.currentTarget).attr('data-product'));
        const productId = $(e.currentTarget).attr('data-product-id');
        this.toggleSave(productData, productId, e.currentTarget);
      } catch (error) {
        console.error('Error saving product:', error);
        window.toastManager.error('Error saving product. Please try again.', 3000);
      }
    });
  }

  toggleSave(product, productId, buttonElement) {
    const $button = $(buttonElement);
    const $icon = $button.find('i');
    
    if (this.savedItems.has(productId)) {
      // Remove from saved
      this.savedItems.delete(productId);
      $icon.removeClass('fa-solid').addClass('fa-regular');
      $button.removeClass('saved');
      window.toastManager.info(`${product.name} removed from wishlist`, 2500);
    } else {
      // Add to saved
      this.savedItems.add(productId);
      $icon.removeClass('fa-regular').addClass('fa-solid');
      $button.addClass('saved');
      window.toastManager.heart(`${product.name} saved to wishlist!`, 2500);
    }

    // Save to localStorage
    localStorage.setItem('savedProducts', JSON.stringify([...this.savedItems]));
    
    console.log('Saved items:', [...this.savedItems]);
  }

  updateSavedButtonStates() {
    // Update all save buttons to show correct state
    $('.save-btn').each((index, button) => {
      const $button = $(button);
      const productId = $button.attr('data-product-id');
      const $icon = $button.find('i');
      
      if (this.savedItems.has(productId)) {
        $icon.removeClass('fa-regular').addClass('fa-solid');
        $button.addClass('saved');
      } else {
        $icon.removeClass('fa-solid').addClass('fa-regular');
        $button.removeClass('saved');
      }
    });
  }

  showMessage(message, type = 'success') {
    window.toastManager.show(message, type, 2500);
  }

  // Method to get saved items
  getSavedItems() {
    return [...this.savedItems];
  }

}

$(document).ready(function() {
  // Add staggered animation delay to cards
  $('.product-card-wrapper').each(function(index) {
    $(this).css('animation-delay', (index * 0.1) + 's');
  });
  
  // Add random Memphis shapes to some cards
  $('.product-card-wrapper').each(function() {
    if (Math.random() > 0.7) {
      const shapes = ['circle', 'triangle', 'square'];
      const colors = ['var(--yellow)', 'var(--green)', 'var(--blue)', 'var(--hotpink)'];
      const randomShape = shapes[Math.floor(Math.random() * shapes.length)];
      const randomColor = colors[Math.floor(Math.random() * colors.length)];
      
      const $shape = $('<div class="floating-shape"></div>');
      $shape.css({
        position: 'absolute',
        width: '8px',
        height: '8px',
        background: randomColor,
        top: Math.random() * 20 + '%',
        right: Math.random() * 20 + '%',
        zIndex: 1,
        borderRadius: randomShape === 'circle' ? '50%' : '0',
        transform: randomShape === 'triangle' ? 'rotate(45deg)' : 'none',
        opacity: 0,
        transition: 'all 0.3s ease'
      });
      
      $(this).append($shape);
      
      $(this).hover(
        function() {
          $(this).find('.floating-shape').css({
            opacity: 1,
            transform: `scale(1.5) ${randomShape === 'triangle' ? 'rotate(225deg)' : 'rotate(180deg)'}`
          });
        },
        function() {
          $(this).find('.floating-shape').css({
            opacity: 0,
            transform: randomShape === 'triangle' ? 'rotate(45deg)' : 'none'
          });
        }
      );
    }
  });
});

// Export for use in other files
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { PRODUCTS, ProductRenderer };
}